# Aurora Seed Interpreter Binary Manifest (Linux x86-64)

header elf_header
org 0x0000
bytes 0x7F454C4602010100
u64 0x0000000000000000
u16 0x0002
u16 0x003E
u32 0x00000001
u64 0x0000000000400080
u64 0x0000000000000040
u64 0x0000000000000000
u32 0x00000000
u16 0x0040
u16 0x0038
u16 0x0001
u16 0x0000
u16 0x0000
u16 0x0000

header program_header
org 0x0040
u32 0x00000001
u32 0x00000007
u64 0x0000000000000000
u64 0x0000000000400000
u64 0x0000000000400000
u64 0x0000000000009000
u64 0x0000000000009000
u64 0x0000000000002000

header text_section
org 0x0080
label entry_main
# Prologue and CLI parsing (hex to be finalized)
bytes 0x4883EC284889E548895DF848896DF0488975E8
bytes 0x48897DE0488B7D08488B7708488B7F10
bytes 0x48897DE8488D3D5C010000488D3528010000
bytes 0xE842000000 # call lexer_next_token

label syscalls
# sys_open
bytes 0xB8020000000F05C3
# sys_read
bytes 0xB8000000000F05C3
# sys_write
bytes 0xB8010000000F05C3
# sys_close
bytes 0xB8030000000F05C3
# sys_exit
bytes 0xB83C0000000F05C3

label zero_buffers
bytes 0x48C7C70060400000
bytes 0x48C7C10008000000
bytes 0x48C7C000000000
bytes 0xF348AB

label lexer_next_token
label lexer_loop
bytes 0x0FB60E80F920740580F90974F5
bytes 0x80F90A740F80F90D740880F90A75E3

label emit_identifier
bytes 0x41B0016641890000448810

label reloc_apply
bytes 0x4C8B2D000000004D85ED741A4C8B2500000000 # displacement pending
bytes 0x498B0424FF15000000004D8B60084C890428
bytes 0x4983C41049FFCD75E4

label parser_loop
bytes 0xE8A6FFFFFF4885C00F84860000004889
bytes 0xC60FB61680FA017538498DBC24000F00
bytes 0x00B90B000000E84401000072243C0174
bytes 0x253C0274283C0372183C0676273C0774
bytes 0x2A3C08742D3C0974303C0A74333C0B74
bytes 0x39E9C4000000E83A000000EBA3E84500
bytes 0x0000EB9CE84B000000EB95E853000000
bytes 0xEB8EE859000000EB87E85F000000EB80
bytes 0xE865000000E976FFFFFFE868000000E9
bytes 0x6CFFFFFFC3

label parse_header
bytes 0xE8C9040000E961FFFFFF909090909090
bytes 0x9090

label parse_org
bytes 0xE8DE040000E94FFFFFFF909090

label parse_numeric
bytes 0xE83B050000E942FFFFFF9090909090

label parse_bytes
bytes 0xE8C9050000E933FFFFFF909090

label parse_label
bytes 0xE825060000E926FFFFFF909090

label parse_ref
bytes 0xE86B060000E919FFFFFF909090

label parse_pad
bytes 0xE89C060000E90CFFFFFF909090

label parse_ascii
bytes 0xE8FF060000E9FFFEFFFF909090

label parse_header_impl
bytes 0x4189DBE895FCFFFF0F82A9FBFFFF4489
bytes 0xDAB001B1014531C04531C9E838FCFFFF
bytes 0x0F82BDFBFFFFC3

label parse_org_impl
bytes 0x4189DBE884FCFFFF0F8282FBFFFF4989
bytes 0xDA4D8D8700A0FFFF498B104839D0723A
bytes 0x483D00000100773A4489DAB101B00245
bytes 0x31C04531C9E8F7FBFFFF720E4889C3E8
bytes 0x41FDFFFF720C4C89D3C34C89D3E96AFB
bytes 0xFFFF4C89D3E962FBFFFF4C89D3E944FB
bytes 0xFFFF4C89D3E952FBFFFF

label parse_numeric_impl
bytes 0x4189DBE81AFCFFFF0F8218FBFFFF4989
bytes 0xDA4989C10FB6C883E90341B801000000
bytes 0x41D3E04183F808740E4489C1C1E1034C
bytes 0x89CA48D3EA755E498DB700A0FFFF488B
bytes 0x164889D04489C14801C8483D00000100
bytes 0x77434489DAB901000000E868FBFFFF72
bytes 0x2C4883EC084C890C244889E64489C148
bytes 0x89D3E8D9FCFFFF72084883C4084C89D3
bytes 0xC34883C4084C89D3E9C5FAFFFF4C89D3
bytes 0xE9BDFAFFFF4C89D3E9B5FAFFFF

label parse_bytes_impl
bytes 0x4189DBE805FCFFFF0F827BFAFFFF4989
bytes 0xDA4989C04189C9498D9700A0FFFF488B
bytes 0x024C01C8483D0000010077354489DAB9
bytes 0x01000000B007E8EFFAFFFF721C4C89C6
bytes 0x4489C9488B1AE868FCFFFF72044C89D3
bytes 0xC34C89D3E95CFAFFFF4C89D3E954FAFF
bytes 0xFF4C89D3E94CFAFFFF

label parse_label_impl
bytes 0x4189DBE8FEFAFFFF0F8212FAFFFF4989
bytes 0xDA4989C0498D9700A0FFFF488B1A4C89
bytes 0xC1E85AFCFFFF721B4489DAB901000000
bytes 0xB0084531C04531C9E884FAFFFF720C4C
bytes 0x89D3C34C89D3E9EBF9FFFF4C89D3E9F9
bytes 0xF9FFFF

label parse_ref_impl
bytes 0x4189DBE8ABFAFFFF0F82BFF9FFFF4989
bytes 0xDA4889C1E890FCFFFF721B4489DAB901
bytes 0x000000B0094531C04531C9E83EFAFFFF
bytes 0x72044C89D3C34C89D3E9BBF9FFFF

label parse_pad_impl
bytes 0x4189DBE883FAFFFF0F8281F9FFFF4989
bytes 0xDA4D8D8700A0FFFF498B104839D07240
bytes 0x483D0000010077404989C14489DAB901
bytes 0x000000B00A4531C0E8F3F9FFFF72114C
bytes 0x89C94889D3E895FCFFFF720C4C89D3C3
bytes 0x4C89D3E963F9FFFF4C89D3E95BF9FFFF
bytes 0x4C89D3E93DF9FFFF4C89D3E94BF9FFFF

label parse_ascii_impl
bytes 0x4189DBE8E6FAFFFF0F8211F9FFFF4989
bytes 0xDA4989C04189C9498D9700A0FFFF488B
bytes 0x024C01C8483D0000010077304489DAB9
bytes 0x01000000B00BE885F9FFFF7217488B1A
bytes 0x4C89C64489C94C89C0E867FCFFFF7214
bytes 0x4C89D3C34C89D3E9EFF8FFFF4C89D3E9
bytes 0xE7F8FFFF4C89D3E9B3F8FFFF

label error_usage
bytes 0x488D3D00000000BA0D000000BF01000000E853000000 # call error_exit

label error_syntax
bytes 0x488D3D00000000BA10000000BF03000000E83D000000 # call error_exit

label error_semantic
bytes 0x488D3D00000000BA12000000BF04000000E827000000 # call error_exit

label error_overflow
bytes 0x488D3D00000000BA0E000000BF05000000E811000000 # call error_exit

label error_exit
bytes 0x4889F2BE01000000B8010000000F0589F80F05

label match_directive
# Input: rsi = token record pointer, rdi = keyword pointer table, rcx = keyword count (11)
# Output: al = opcode (1..11) on match with CF clear; CF set on failure and al zero
bytes 0x440FB74E024585C974408B56044903D44C8BC24889FA31C0B0014885C9742B4989CB488B3A4C89C6
bytes 0x4489C9F3A6750B410FB6174585D27502F8C34989D9FEC04883C20848FFC975D731C0F9C3

label directive_emit
# Input: al = opcode, cl = arg count, rdx/r8d/r9d = operand descriptors, r14 = directive tail pointer, r15 = output buffer base
# Output: writes directive record (16 bytes) and advances r14; CF set on overflow
bytes 0x4D8D97000CFFFF4D39D6733531FF4989
bytes 0x3E49897E084188060FB6C96641894E02
bytes 0x83F90074164189560483F901740D4589
bytes 0x460883F902740445894E0C4983C610F8
bytes 0xC331C0F9C3

label parser_expect_identifier
# Input: rbx = token index, r13 = token records base, r12 = token storage base
# Output: rax = token record pointer, CF cleared on success, set on failure
bytes 0x498D44DD000FB610
bytes 0x80FA01750548FFC3
bytes 0xF8C331C0F9C3

label parser_expect_numeric
# Input: rbx = token index, r13 = token records base, r12 = token storage base
# Output: rax = parsed 64-bit value, CF cleared on success, set on failure
bytes 0x498D44DD000FB610
bytes 0x80FA0275770FB748
bytes 0x0285C9746F8B5004
bytes 0x4C01E2440FB64001
bytes 0x41F6C002740C83F9
bytes 0x0272594883C20283
bytes 0xE90283F910774D85
bytes 0xC974494531C90FB6
bytes 0x0248FFC23C30723C
bytes 0x3C3976123C417204
bytes 0x3C46760E3C61722C
bytes 0x3C66760CEB262C30
bytes 0xEB0C2C41040AEB06
bytes 0x2C61040AEB0049C1
bytes 0xE1040FB6C04909C1
bytes 0xFFC975C248FFC34C
bytes 0x89C8F8C331C0F9C3

label parser_expect_bytes
# Input: rbx = token index, r13 = token records base, r12 = token storage base
# Output: rax = pointer to hex data, rcx = byte count, CF cleared on success
bytes 0x498D44DD000FB610
bytes 0x80FA0275380FB748
bytes 0x0285C974308B5004
bytes 0x4C01E2440FB64001
bytes 0x41F6C002740C83F9
bytes 0x02721A4883C20283
bytes 0xE90285C9740FF6C1
bytes 0x01750AD1E94889D0
bytes 0x48FFC3F8C331C031
bytes 0xC9F9C3

label parser_expect_string
# Input: rbx = token index, r13 = token records base, r12 = token storage base
# Output: rax/rsi = pointer to literal bytes, rcx = length, CF cleared on success
bytes 0x498D54DD000FB602
bytes 0x3C0375120FB74A02
bytes 0x8B42044C01E04889
bytes 0xC648FFC3F8C331C0
bytes 0x31C931F6F9C3

label parser_apply_org
# Input: rbx = requested absolute offset, r15 = output buffer base
# Output: cursor updated on success, CF set on backward/overflow
bytes 0x4D8D8F00A0FFFF49
bytes 0x8B014839C3721F48
bytes 0x81FB00000100770F49
bytes 0x8919493B59087604
bytes 0x49895908F8C34889
bytes 0xC331C0F9C34889C3
bytes 0x31C0F9C3

label parser_emit_bytes
# Input: rsi = source pointer, rcx = length, rbx = cursor offset, r15 = output buffer base
# Output: rbx advanced to new cursor offset, CF cleared on success, set on overflow
bytes 0x488D140B4881FA00
bytes 0x00010077254885C9
bytes 0x7407498D3C1FFCF3
bytes 0xA44889D34D8D8700
bytes 0xA0FFFF498918493B
bytes 0x5808760449895808
bytes 0xF8C331C0F9C3

label parser_record_label
# Input: rcx = token record pointer, rbx = current offset, r12 = token storage base, r15 = output buffer base
# Output: registers updated with symbol table entry on success, CF set on duplicate/overflow
bytes 0x0FB751024189D385
bytes 0xD2746D8B71044D8D04
bytes 0x3448B825232284E49C
bytes 0xF2CB49BAB301000000
bytes 0x010000450FB6084430
bytes 0xC8490FAFC249FFC0FF
bytes 0xCA75EE498DBF0024FF
bytes 0xFFB9000100004C8B0F
bytes 0x4D85C9740D4939C174
bytes 0x1F4883C718E2EDEB1B
bytes 0x488907897708664489
bytes 0x5F0C66C7470E010048
bytes 0x895F10F8C331C0F9C3
bytes 0x31C0F9C331C0F9C3

label parser_queue_ref
# Input: rcx = identifier token record, r12 = token storage base, r15 = output buffer base
# Output: enqueues relocation entry capturing symbol hash and current cursor offset, CF set on overflow
bytes 0x0FB7510285D274688B71044D8D0434
bytes 0x48B825232284E49CF2CB49BAB3010000
bytes 0x00010000450FB6084430C8490FAFC2
bytes 0x49FFC0FFCA75EE498DBF0060FFFFB9
bytes 0x000100004C8B0F4D85C974084883C7
bytes 0x10E2F2EB1F4889074D8D8F00A0FFFF
bytes 0x4D8B014489470866C7470C080066C7
bytes 0x470E0100F8C331C0F9C3

label parser_emit_pad
# Input: rcx = target absolute offset, rbx = current cursor, r15 = output buffer base
# Output: rbx advanced to target with zero fill, CF cleared on success, set on failure
bytes 0x4839D9723D4989C8
bytes 0x4881F90000010077
bytes 0x2D4889CA4829DA74
bytes 0x0C498D3C1F31C048
bytes 0x89D1FCF3AA4C89C3
bytes 0x4D8D8F00A0FFFF49
bytes 0x8919493B59087604
bytes 0x49895908F8C331C0
bytes 0xF9C331C0F9C3

label parser_emit_ascii
# Input: rax = string data pointer, rcx = raw token length, rbx = cursor, r15 = output buffer base
# Output: emits decoded ASCII bytes (handling escapes) and advances cursor/high-water, CF on failure/overflow
bytes 0x4989C04889C64889C748
bytes 0x31D24885C9745E0FB606
bytes 0x48FFC648FFC93C5C7544
bytes 0x4885C90F84840000000F
bytes 0xB60648FFC648FFC93C6E
bytes 0x74163C7474163C727416
bytes 0x3C3074163C2274163C5C
bytes 0x7416EB61B00AEB14B009
bytes 0xEB10B00DEB0C31C0EB08
bytes 0xB022EB04B05CEB008807
bytes 0x48FFC748FFC24885C975
bytes 0xA24889D14C89C6488D14
bytes 0x0B4881FA000001007725
bytes 0x4885C97407498D3C1FFC
bytes 0xF3A44889D34D8D8F00A0
bytes 0xFFFF498919493B590876
bytes 0x0449895908F8C331C0F9
bytes 0xC331C031C931F6F9C3

header data_tables
org 0x2000
label token_storage
pad 0x2000
label token_records
pad 0x3000
label directive_records
pad 0x3800
label symbol_table
pad 0x3C00
label relocation_table
pad 0x4000
label cursor_block
pad 0x6000
label output_buffer
pad 0x10000
